{% extends "layout.html" %}

{% block content %}
<div class="mb-8 flex justify-between items-center">
    <h2 class="text-3xl font-bold text-slate-800">My Learning Dashboard</h2>
    
    {% if is_google_linked %}
    <a href="/sync_calendar" class="bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 px-4 py-2 rounded-lg font-bold shadow-sm transition flex items-center gap-2 text-sm">
        ğŸ“… ClassroomåŒæœŸ
    </a>
    {% else %}
    <a href="/google_login" class="bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 rounded-lg font-bold shadow-sm transition flex items-center gap-2 text-sm">
        Googleé€£æº
    </a>
    {% endif %}
</div>

<div class="mb-10 bg-white rounded-xl shadow-md border border-slate-200 p-6">
    <h3 class="text-lg font-bold text-indigo-600 mb-4 flex items-center gap-2">
        ğŸš€ å­¦ã³ãŸã„ã“ã¨ã‚’å…¥åŠ› (è‡ªä¸»å­¦ç¿’)
    </h3>
    <form action="/create_self_study" method="post" class="flex gap-4 items-start">
        <div class="flex-grow space-y-2">
            <input type="text" name="title" placeholder="ãƒ†ãƒ¼ãƒ (ä¾‹: é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ä»•çµ„ã¿)" required
                class="w-full border-slate-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm p-2 border">
            <input type="text" name="description" placeholder="è©³ç´°ãªæŒ‡ç¤º (ä¾‹: é«˜æ ¡ç”Ÿã§ã‚‚ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã‚²ãƒ¼ãƒˆæ–¹å¼ã‚’ä¸­å¿ƒã«è§£èª¬ã—ã¦)" 
                class="w-full border-slate-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm p-2 border">
        </div>
        <button type="submit" class="bg-indigo-600 text-white px-6 py-4 rounded-lg font-bold hover:bg-indigo-700 transition shadow whitespace-nowrap">
            æˆæ¥­ã‚’ä½œæˆ
        </button>
    </form>
</div>

<div class="mb-12">
    <h3 class="text-xl font-bold text-slate-800 mb-4 border-l-4 border-indigo-600 pl-3">
        ğŸ‘¨â€ğŸ« å…ˆç”Ÿã‹ã‚‰ã®èª²é¡Œ
    </h3>
    
    {% if teacher_assignments %}
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for assignment in teacher_assignments %}
        <div class="bg-white rounded-xl shadow-md border border-slate-200 overflow-hidden hover:shadow-xl hover:-translate-y-1 transition duration-300 flex flex-col">
            <div class="p-6 flex-grow">
                <div class="flex justify-between items-center mb-3">
                    <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">Class Assignment</span>
                    <span class="text-xs text-slate-400 font-mono">{{ assignment.created_at.strftime('%Y-%m-%d') }}</span>
                </div>
                <h3 class="text-xl font-bold text-slate-900 mb-3 line-clamp-2">{{ assignment.title }}</h3>
                <p class="text-slate-600 text-sm line-clamp-3">{{ assignment.description }}</p>
            </div>
            
            <div class="bg-slate-50 px-6 py-4 border-t border-slate-100 grid grid-cols-2 gap-3">
                <a href="/lesson_page/{{ assignment.id }}" class="flex justify-center items-center gap-2 bg-white border border-slate-300 text-slate-700 py-2 rounded-lg text-sm font-bold hover:bg-indigo-50 transition">
                    ğŸ“– æˆæ¥­ã‚’å—ã‘ã‚‹
                </a>
                <a href="/quiz_page/{{ assignment.id }}" class="flex justify-center items-center gap-2 bg-indigo-600 text-white py-2 rounded-lg text-sm font-bold hover:bg-indigo-700 transition shadow-sm">
                    âœï¸ ç¢ºèªãƒ†ã‚¹ãƒˆ
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
        <p class="text-slate-500 bg-slate-50 p-4 rounded-lg">ç¾åœ¨ã€å…ˆç”Ÿã‹ã‚‰ã®èª²é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endif %}
</div>

<div class="mb-12">
    <h3 class="text-xl font-bold text-slate-800 mb-4 border-l-4 border-emerald-500 pl-3">
        ğŸ“š My è‡ªä¸»å­¦ç¿’ãƒªã‚¹ãƒˆ
    </h3>
    
    {% if my_lessons %}
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for assignment in my_lessons %}
        <div class="bg-white rounded-xl shadow-sm border border-emerald-100 overflow-hidden hover:shadow-md transition flex flex-col">
            <div class="p-6 flex-grow">
                <div class="flex justify-between items-center mb-3">
                    <span class="bg-emerald-100 text-emerald-800 text-xs font-bold px-2 py-1 rounded">Self Study</span>
                    <span class="text-xs text-slate-400 font-mono">{{ assignment.created_at.strftime('%Y-%m-%d') }}</span>
                </div>
                <h3 class="text-lg font-bold text-slate-900 mb-2">{{ assignment.title }}</h3>
                <p class="text-slate-500 text-xs line-clamp-2">{{ assignment.description }}</p>
            </div>
            <div class="bg-slate-50 px-6 py-3 border-t border-slate-100">
                <a href="/lesson_page/{{ assignment.id }}" class="block w-full text-center bg-white border border-emerald-500 text-emerald-600 py-2 rounded-lg text-sm font-bold hover:bg-emerald-50 transition">
                    ğŸ“– å¾©ç¿’ã™ã‚‹
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
        <p class="text-slate-500 bg-slate-50 p-4 rounded-lg">ã¾ã è‡ªä¸»å­¦ç¿’ã‚’ä½œæˆã—ã¦ã„ã¾ã›ã‚“ã€‚ä¸Šã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
    {% endif %}
</div>

<div class="bg-gradient-to-r from-slate-700 to-slate-800 rounded-xl shadow-lg p-6 text-white flex justify-between items-center">
    <div>
        <h3 class="text-xl font-bold">ğŸ› ï¸ è‡ªç”±å­¦ç¿’ãƒ„ãƒ¼ãƒ«</h3>
        <p class="text-slate-300 text-sm">æ‰‹æŒã¡ã®ãƒ¬ãƒãƒ¼ãƒˆã‚„å•é¡Œé›†ã®æ¡ç‚¹ã¯ã“ã¡ã‚‰</p>
    </div>
    <a href="/tools" class="bg-white text-slate-800 px-6 py-2 rounded-lg font-bold hover:bg-slate-100 transition">ãƒ„ãƒ¼ãƒ«ã¸ â†’</a>
</div>
{% endblock %}